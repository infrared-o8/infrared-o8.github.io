<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1ZCVC00N3L"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1ZCVC00N3L');
    </script>

    <script type="text/javascript">
    var _iub = _iub || [];
    _iub.csConfiguration = {"siteId":4064226,"cookiePolicyId":47103777,"lang":"en","storage":{"useSiteId":true}};
    </script>
    <script type="text/javascript" src="https://cs.iubenda.com/autoblocking/4064226.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/gpp/stub.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3849009117213465"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeForge - Build Your Resume</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg: #0f0f23;
            --bg-light: #1a1a2e;
            --text: #e2e8f0;
            --text-dim: #94a3b8;
            --accent: #f59e0b;
            --glass: rgba(255, 255, 255, 0.1);
            --success: #10b981;
            --error: #ef4444;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: scale(0.9) translateY(-20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-header h2 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-header p {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .template-card {
            background: var(--glass);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .template-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.2);
        }

        .template-card.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .template-preview {
            width: 100%;
            height: 200px;
            background: white;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-size: 0.8rem;
            overflow: hidden;
            position: relative;
        }

        .template-preview iframe {
            width: 100%;
            height: 400px;
            transform: scale(0.5);
            transform-origin: top left;
            border: none;
            pointer-events: none;
        }

        .template-info h3 {
            color: var(--text);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .template-info p {
            color: var(--text-dim);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .template-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .feature-tag {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-dim);
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--text);
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 1rem 2rem;
            backdrop-filter: blur(20px);
            background: rgba(15, 15, 35, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Main Layout */
        .container {
            display: flex;
            min-height: 100vh;
            margin-top: 80px;
        }

        .form-section {
            flex: 1;
            padding: 2rem;
            background: var(--bg);
            overflow-y: auto;
            max-height: calc(100vh - 80px);
        }

        .preview-section {
            flex: 1;
            padding: 2rem;
            background: var(--bg-light);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            max-height: calc(100vh - 80px);
        }

        /* Form Styles */
        .form-card {
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(20px);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-card h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
        }

        input, textarea, select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text);
            font-family: inherit;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: var(--glass);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        /* Dynamic Sections */
        .dynamic-section {
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.02);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .remove-btn {
            background: var(--error);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            background: #dc2626;
        }

        /* Preview Styles */
        .preview-container {
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
        }

        .preview-container iframe {
            width: 100%;
            height: 1000px;
            border: none;
            background: white;
        }

        .template-selector {
            background: var(--glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .current-template {
            color: var(--text);
            font-weight: 500;
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }

            .form-section, .preview-section {
                flex: none;
                max-height: none;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .templates-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading and Success States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .success-message {
            background: var(--success);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
        }

        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Template Selection Modal -->
    <div id="templateModal" class="modal active">
        <div class="modal-content">
            <button class="close-modal" onclick="closeTemplateModal()">&times;</button>
            <div class="modal-header">
                <h2>üé® Choose Your Resume Template</h2>
                <p>Select a professional template that matches your style and industry</p>
            </div>
            
            <div class="templates-grid" id="templatesGrid">
                <div class="spinner"></div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="confirmTemplateSelection()" id="confirmBtn" disabled>
                    ‚ú® Start Building with Selected Template
                </button>
            </div>
        </div>
    </div>

    <header>
        <nav>
            <div class="logo">ResumeForge</div>
            <div class="nav-actions">
                <button class="btn btn-secondary btn-small" onclick="changeTemplate()">üé® Change Template</button>
                <button class="btn btn-secondary btn-small" onclick="clearForm()">üóëÔ∏è Clear</button>
                <button class="btn btn-success btn-small" onclick="downloadPDF()">üìÑ Download PDF</button>
            </div>
        </nav>
    </header>

    <div class="container">
        <!-- Form Section -->
        <div class="form-section">
            <div class="template-selector">
                <div>
                    <span class="current-template">Current Template: <span id="currentTemplateName">Loading...</span></span>
                </div>
                <small style="color: var(--text-dim);">Auto-saving your progress...</small>
            </div>

            <form id="resumeForm">
                <!-- Personal Information -->
                <div class="form-card">
                    <h2>üë§ Personal Information</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="tel" id="phone" name="phone">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city">
                        </div>
                        <div class="form-group">
                            <label for="linkedin">LinkedIn</label>
                            <input type="url" id="linkedin" name="linkedin" placeholder="https://linkedin.com/in/yourname">
                        </div>
                    </div>
                </div>

                <!-- Professional Summary -->
                <div class="form-card">
                    <h2>üìù Professional Summary</h2>
                    <div class="form-group">
                        <label for="summary">Brief summary about yourself</label>
                        <textarea id="summary" name="summary" placeholder="Write a brief professional summary highlighting your key skills and career objectives..."></textarea>
                    </div>
                </div>

                <!-- Education -->
                <div class="form-card">
                    <h2>üéì Education</h2>
                    <div id="educationContainer">
                        <div class="dynamic-section">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Degree/Course *</label>
                                    <input type="text" name="degree" required placeholder="e.g., Bachelor of Computer Science">
                                </div>
                                <div class="form-group">
                                    <label>Institution *</label>
                                    <input type="text" name="institution" required placeholder="e.g., University of Technology">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Year/Duration</label>
                                    <input type="text" name="duration" placeholder="e.g., 2020-2024">
                                </div>
                                <div class="form-group">
                                    <label>Grade/CGPA</label>
                                    <input type="text" name="grade" placeholder="e.g., 8.5 CGPA">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="addEducation()">+ Add Education</button>
                </div>

                <!-- Experience -->
                <div class="form-card">
                    <h2>üíº Experience</h2>
                    <div id="experienceContainer">
                        <div class="dynamic-section">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Job Title</label>
                                    <input type="text" name="jobTitle" placeholder="e.g., Software Developer Intern">
                                </div>
                                <div class="form-group">
                                    <label>Company</label>
                                    <input type="text" name="company" placeholder="e.g., Tech Solutions Inc.">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Duration</label>
                                    <input type="text" name="workDuration" placeholder="e.g., June 2023 - Aug 2023">
                                </div>
                                <div class="form-group">
                                    <label>Location</label>
                                    <input type="text" name="location" placeholder="e.g., Mumbai, India">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea name="jobDescription" placeholder="Describe your role, responsibilities, and achievements..."></textarea>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="addExperience()">+ Add Experience</button>
                </div>

                <!-- Projects -->
                <div class="form-card">
                    <h2>üöÄ Projects</h2>
                    <div id="projectsContainer">
                        <div class="dynamic-section">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Project Name</label>
                                    <input type="text" name="projectName" placeholder="e.g., E-commerce Website">
                                </div>
                                <div class="form-group">
                                    <label>Technologies Used</label>
                                    <input type="text" name="technologies" placeholder="e.g., React, Node.js, MongoDB">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Project Description</label>
                                <textarea name="projectDescription" placeholder="Describe your project, your role, and key achievements..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Project Link (Optional)</label>
                                <input type="url" name="projectLink" placeholder="https://github.com/yourname/project">
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="addProject()">+ Add Project</button>
                </div>

                <!-- Skills -->
                <div class="form-card">
                    <h2>‚ö° Skills</h2>
                    <div class="form-group">
                        <label for="skills">Skills (comma-separated)</label>
                        <textarea id="skills" name="skills" placeholder="e.g., JavaScript, Python, React, Node.js, Git, Problem Solving, Team Leadership"></textarea>
                    </div>
                </div>
            </form>
        </div>

        <!-- Preview Section -->
        <div class="preview-section">
            <div class="preview-container" id="resumePreview">
                <iframe id="previewFrame" src="about:blank"></iframe>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedTemplate = null;
        let currentTemplateData = null;
        let availableTemplates = [];
        let autoSaveInterval = null;

        // Template definitions (in a real app, this would come from your server)
        const templateDefinitions = [
            {
                id: 'template1',
                name: 'Modern Professional',
                description: 'Clean and modern design perfect for tech and business professionals',
                features: ['ATS-Friendly', 'Clean Layout', 'Professional'],
                file: 'templates/template1.html'
            },
            {
                id: 'template2',
                name: 'Creative Designer',
                description: 'Stylish and creative layout ideal for designers and creative roles',
                features: ['Creative', 'Visual Impact', 'Modern'],
                file: 'templates/template2.html'
            },
            {
                id: 'template3',
                name: 'Executive Classic',
                description: 'Traditional and sophisticated design for senior-level positions',
                features: ['Executive', 'Classic', 'Sophisticated'],
                file: 'templates/template3.html'
            },
            {
                id: 'template4',
                name: 'Minimalist Clean',
                description: 'Ultra-clean minimalist design focusing on content over decoration',
                features: ['Minimalist', 'Clean', 'Content-Focused'],
                file: 'templates/template4.html'
            }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadAvailableTemplates();
            setupFormListeners();
            loadSavedData();
        });

        // Load available templates
        async function loadAvailableTemplates() {
            const templatesGrid = document.getElementById('templatesGrid');
            templatesGrid.innerHTML = '';

            for (const template of templateDefinitions) {
                const templateCard = document.createElement('div');
                templateCard.className = 'template-card';
                templateCard.onclick = () => selectTemplate(template.id);
                
                templateCard.innerHTML = `
                    <div class="template-preview">
                        <iframe src="${template.file}" sandbox="allow-same-origin"></iframe>
                    </div>
                    <div class="template-info">
                        <h3>${template.name}</h3>
                        <p>${template.description}</p>
                        <div class="template-features">
                            ${template.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                        </div>
                    </div>
                `;
                
                templatesGrid.appendChild(templateCard);
                availableTemplates.push(template);
            }
        }

        // Select template
        function selectTemplate(templateId) {
            // Remove previous selection
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.currentTarget.classList.add('selected');
            selectedTemplate = templateId;
            
            // Enable confirm button
            document.getElementById('confirmBtn').disabled = false;
        }

        // Confirm template selection
        async function confirmTemplateSelection() {
            if (!selectedTemplate) return;
            
            const template = availableTemplates.find(t => t.id === selectedTemplate);
            if (!template) return;
            
            // Save selected template
            saveToStorage('selectedTemplate', selectedTemplate);
            
            // Load template content
            try {
                const response = await fetch(template.file);
                currentTemplateData = await response.text();
                
                // Update UI
                document.getElementById('currentTemplateName').textContent = template.name;
                closeTemplateModal();
                
                // Update preview
                updatePreview();
                
                // Start auto-save
                startAutoSave();
                
                showSuccessMessage(`Template "${template.name}" loaded successfully!`);
            } catch (error) {
                console.error('Error loading template:', error);
                showErrorMessage('Failed to load template. Please try again.');
            }
        }

        // Close template modal
        function closeTemplateModal() {
            document.getElementById('templateModal').classList.remove('active');
        }

        // Change template
        function changeTemplate() {
            document.getElementById('templateModal').classList.add('active');
        }

        // Setup form listeners
        function setupFormListeners() {
            const form = document.getElementById('resumeForm');
            const inputs = form.querySelectorAll('input, textarea');
            
            inputs.forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
                input.addEventListener('input', debounce(saveFormData, 1000));
            });
        }

        // Update preview with template
        function updatePreview() {
            if (!currentTemplateData) return;
            
            const formData = getFormData();
            let templateHTML = currentTemplateData;
            
            // Replace template variables
            templateHTML = templateHTML.replace(/\{\{firstName\}\}/g, formData.firstName || '');
            templateHTML = templateHTML.replace(/\{\{lastName\}\}/g, formData.lastName || '');
            templateHTML = templateHTML.replace(/\{\{fullName\}\}/g, `${formData.firstName || ''} ${formData.lastName || ''}`.trim() || 'Your Name');
            templateHTML = templateHTML.replace(/\{\{email\}\}/g, formData.email || '');
            templateHTML = templateHTML.replace(/\{\{phone\}\}/g, formData.phone || '');
            templateHTML = templateHTML.replace(/\{\{city\}\}/g, formData.city || '');
            templateHTML = templateHTML.replace(/\{\{linkedin\}\}/g, formData.linkedin || '');
            templateHTML = templateHTML.replace(/\{\{summary\}\}/g, formData.summary || '');
            
            // Handle education
            let educationHTML = '';
            formData.education.forEach(edu => {
                if (edu.degree || edu.institution) {
                    educationHTML += `
                        <div class="education-item">
                            <h4>${edu.degree || 'Course/Degree'}</h4>
                            <div class="meta">${edu.institution || 'Institution'} ${edu.duration ? `‚Ä¢ ${edu.duration}` : ''}</div>
                            ${edu.grade ? `<p>Grade: ${edu.grade}</p>` : ''}
                        </div>
                    `;
                }
            });
            templateHTML = templateHTML.replace(/\{\{education\}\}/g, educationHTML);
            
            // Handle experience
            let experienceHTML = '';
            formData.experience.forEach(exp => {
                if (exp.jobTitle || exp.company || exp.jobDescription) {
                    experienceHTML += `
                        <div class="experience-item">
                            <h4>${exp.jobTitle || 'Job Title'}</h4>
                            <div class="meta">${exp.company || 'Company'} ${exp.workDuration ? `‚Ä¢ ${exp.workDuration}` : ''} ${exp.location ? `‚Ä¢ ${exp.location}` : ''}</div>
                            ${exp.jobDescription ? `<p>${exp.jobDescription}</p>` : ''}
                        </div>
                    `;
                }
            });
            templateHTML = templateHTML.replace(/\{\{experience\}\}/g, experienceHTML);
            
// Handle projects
            let projectsHTML = '';
            formData.projects.forEach(proj => {
                if (proj.projectName || proj.projectDescription) {
                    projectsHTML += `
                        <div class="project-item">
                            <h4>${proj.projectName || 'Project Name'}</h4>
                            ${proj.technologies ? `<div class="meta">Technologies: ${proj.technologies}</div>` : ''}
                            ${proj.projectDescription ? `<p>${proj.projectDescription}</p>` : ''}
                            ${proj.projectLink ? `<a href="${proj.projectLink}" target="_blank">View Project</a>` : ''}
                        </div>
                    `;
                }
            });
            templateHTML = templateHTML.replace(/\{\{projects\}\}/g, projectsHTML);
            
            // Handle skills
            const skillsArray = formData.skills ? formData.skills.split(',').map(skill => skill.trim()).filter(skill => skill) : [];
            const skillsHTML = skillsArray.map(skill => `<span class="skill-tag">${skill}</span>`).join('');
            templateHTML = templateHTML.replace(/\{\{skills\}\}/g, skillsHTML);
            
            // Update preview iframe
            const previewFrame = document.getElementById('previewFrame');
            const doc = previewFrame.contentDocument || previewFrame.contentWindow.document;
            doc.open();
            doc.write(templateHTML);
            doc.close();
        }

        // Get form data
        function getFormData() {
            const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                city: document.getElementById('city').value,
                linkedin: document.getElementById('linkedin').value,
                summary: document.getElementById('summary').value,
                skills: document.getElementById('skills').value,
                education: [],
                experience: [],
                projects: []
            };
            
            // Get education data
            const educationSections = document.querySelectorAll('#educationContainer .dynamic-section');
            educationSections.forEach(section => {
                const education = {
                    degree: section.querySelector('input[name="degree"]').value,
                    institution: section.querySelector('input[name="institution"]').value,
                    duration: section.querySelector('input[name="duration"]').value,
                    grade: section.querySelector('input[name="grade"]').value
                };
                formData.education.push(education);
            });
            
            // Get experience data
            const experienceSections = document.querySelectorAll('#experienceContainer .dynamic-section');
            experienceSections.forEach(section => {
                const experience = {
                    jobTitle: section.querySelector('input[name="jobTitle"]').value,
                    company: section.querySelector('input[name="company"]').value,
                    workDuration: section.querySelector('input[name="workDuration"]').value,
                    location: section.querySelector('input[name="location"]').value,
                    jobDescription: section.querySelector('textarea[name="jobDescription"]').value
                };
                formData.experience.push(experience);
            });
            
            // Get projects data
            const projectSections = document.querySelectorAll('#projectsContainer .dynamic-section');
            projectSections.forEach(section => {
                const project = {
                    projectName: section.querySelector('input[name="projectName"]').value,
                    technologies: section.querySelector('input[name="technologies"]').value,
                    projectDescription: section.querySelector('textarea[name="projectDescription"]').value,
                    projectLink: section.querySelector('input[name="projectLink"]').value
                };
                formData.projects.push(project);
            });
            
            return formData;
        }

        // Add education section
        function addEducation() {
            const container = document.getElementById('educationContainer');
            const newSection = document.createElement('div');
            newSection.className = 'dynamic-section';
            newSection.innerHTML = `
                <div class="section-header">
                    <h4>Education Entry</h4>
                    <button type="button" class="remove-btn" onclick="removeSection(this)">Remove</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Degree/Course *</label>
                        <input type="text" name="degree" required placeholder="e.g., Bachelor of Computer Science">
                    </div>
                    <div class="form-group">
                        <label>Institution *</label>
                        <input type="text" name="institution" required placeholder="e.g., University of Technology">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Year/Duration</label>
                        <input type="text" name="duration" placeholder="e.g., 2020-2024">
                    </div>
                    <div class="form-group">
                        <label>Grade/CGPA</label>
                        <input type="text" name="grade" placeholder="e.g., 8.5 CGPA">
                    </div>
                </div>
            `;
            container.appendChild(newSection);
            
            // Add event listeners to new inputs
            newSection.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
                input.addEventListener('input', debounce(saveFormData, 1000));
            });
        }

        // Add experience section
        function addExperience() {
            const container = document.getElementById('experienceContainer');
            const newSection = document.createElement('div');
            newSection.className = 'dynamic-section';
            newSection.innerHTML = `
                <div class="section-header">
                    <h4>Experience Entry</h4>
                    <button type="button" class="remove-btn" onclick="removeSection(this)">Remove</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Job Title</label>
                        <input type="text" name="jobTitle" placeholder="e.g., Software Developer Intern">
                    </div>
                    <div class="form-group">
                        <label>Company</label>
                        <input type="text" name="company" placeholder="e.g., Tech Solutions Inc.">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Duration</label>
                        <input type="text" name="workDuration" placeholder="e.g., June 2023 - Aug 2023">
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" name="location" placeholder="e.g., Mumbai, India">
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea name="jobDescription" placeholder="Describe your role, responsibilities, and achievements..."></textarea>
                </div>
            `;
            container.appendChild(newSection);
            
            // Add event listeners to new inputs
            newSection.querySelectorAll('input, textarea').forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
                input.addEventListener('input', debounce(saveFormData, 1000));
            });
        }

        // Add project section
        function addProject() {
            const container = document.getElementById('projectsContainer');
            const newSection = document.createElement('div');
            newSection.className = 'dynamic-section';
            newSection.innerHTML = `
                <div class="section-header">
                    <h4>Project Entry</h4>
                    <button type="button" class="remove-btn" onclick="removeSection(this)">Remove</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Project Name</label>
                        <input type="text" name="projectName" placeholder="e.g., E-commerce Website">
                    </div>
                    <div class="form-group">
                        <label>Technologies Used</label>
                        <input type="text" name="technologies" placeholder="e.g., React, Node.js, MongoDB">
                    </div>
                </div>
                <div class="form-group">
                    <label>Project Description</label>
                    <textarea name="projectDescription" placeholder="Describe your project, your role, and key achievements..."></textarea>
                </div>
                <div class="form-group">
                    <label>Project Link (Optional)</label>
                    <input type="url" name="projectLink" placeholder="https://github.com/yourname/project">
                </div>
            `;
            container.appendChild(newSection);
            
            // Add event listeners to new inputs
            newSection.querySelectorAll('input, textarea').forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
                input.addEventListener('input', debounce(saveFormData, 1000));
            });
        }

        // Remove section
        function removeSection(button) {
            const section = button.closest('.dynamic-section');
            section.remove();
            updatePreview();
            saveFormData();
        }

        // Clear form
        function clearForm() {
            if (confirm('Are you sure you want to clear all form data? This action cannot be undone.')) {
                document.getElementById('resumeForm').reset();
                
                // Reset dynamic sections to have only one each
                resetDynamicSections();
                
                // Clear stored data
                clearStoredData();
                
                // Update preview
                updatePreview();
                
                showSuccessMessage('Form cleared successfully!');
            }
        }

        // Reset dynamic sections
        function resetDynamicSections() {
            const containers = ['educationContainer', 'experienceContainer', 'projectsContainer'];
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                const sections = container.querySelectorAll('.dynamic-section');
                
                // Remove all but the first section
                for (let i = 1; i < sections.length; i++) {
                    sections[i].remove();
                }
                
                // Clear the first section
                const firstSection = container.querySelector('.dynamic-section');
                if (firstSection) {
                    firstSection.querySelectorAll('input, textarea').forEach(input => {
                        input.value = '';
                    });
                }
            });
        }

        // Download PDF
        function downloadPDF() {
            const previewFrame = document.getElementById('previewFrame');
            const previewDoc = previewFrame.contentDocument || previewFrame.contentWindow.document;
            
            if (!previewDoc.body.innerHTML.trim()) {
                showErrorMessage('Please fill in your information first!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            // Get the content from the preview
            const content = previewDoc.body;
            
            // Use html2canvas alternative or basic text extraction
            const textContent = content.innerText || content.textContent;
            const lines = textContent.split('\n').filter(line => line.trim());
            
            let yPosition = 20;
            const lineHeight = 6;
            const maxWidth = 170;
            
            lines.forEach(line => {
                if (yPosition > 280) {
                    pdf.addPage();
                    yPosition = 20;
                }
                
                const splitText = pdf.splitTextToSize(line, maxWidth);
                pdf.text(splitText, 20, yPosition);
                yPosition += splitText.length * lineHeight + 2;
            });
            
            // Get user name for filename
            const firstName = document.getElementById('firstName').value || 'Resume';
            const lastName = document.getElementById('lastName').value || '';
            const filename = `${firstName}_${lastName}_Resume.pdf`.replace(/\s+/g, '_');
            
            pdf.save(filename);
            showSuccessMessage('PDF downloaded successfully!');
        }

        // Utility functions
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Storage functions
        function saveToStorage(key, data) {
            const storage = {};
            storage[key] = data;
            // In a real app, you'd use localStorage or send to server
            console.log('Saving to storage:', key, data);
        }

        function getFromStorage(key) {
            // In a real app, you'd retrieve from localStorage or server
            return null;
        }

        function saveFormData() {
            const formData = getFormData();
            saveToStorage('resumeFormData', formData);
        }

        function loadSavedData() {
            const savedData = getFromStorage('resumeFormData');
            if (savedData) {
                populateForm(savedData);
                updatePreview();
            }
        }

        function clearStoredData() {
            saveToStorage('resumeFormData', null);
            saveToStorage('selectedTemplate', null);
        }

        function populateForm(data) {
            // Populate basic fields
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && typeof data[key] === 'string') {
                    element.value = data[key];
                }
            });
            
            // Populate dynamic sections would require more complex logic
            console.log('Loading saved data:', data);
        }

        function startAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
            }
            autoSaveInterval = setInterval(saveFormData, 30000); // Save every 30 seconds
        }

        // Message functions
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function showErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'success-message';
            errorDiv.style.background = 'var(--error)';
            errorDiv.textContent = message;
            
            document.body.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 3000);
        }
        /*
        // Create sample templates (since external files won't work in this demo)
        function createSampleTemplate(templateId) {
            const templates = {
                template1: `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                            .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; }
                            .section { margin: 20px 0; }
                            .section h3 { color: #333; border-bottom: 1px solid #ccc; }
                            .education-item, .experience-item, .project-item { margin: 10px 0; }
                            .meta { color: #666; font-style: italic; }
                            .skill-tag { background: #f0f0f0; padding: 2px 8px; margin: 2px; border-radius: 10px; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>{{fullName}}</h1>
                            <p>{{email}} ‚Ä¢ {{phone}} ‚Ä¢ {{city}} ‚Ä¢ {{linkedin}}</p>
                        </div>
                        <div class="section">
                            <h3>Professional Summary</h3>
                            <p>{{summary}}</p>
                        </div>
                        <div class="section">
                            <h3>Education</h3>
                            {{education}}
                        </div>
                        <div class="section">
                            <h3>Experience</h3>
                            {{experience}}
                        </div>
                        <div class="section">
                            <h3>Projects</h3>
                            {{projects}}
                        </div>
                        <div class="section">
                            <h3>Skills</h3>
                            {{skills}}
                        </div>
                    </body>
                    </html>
                `,
                template2: `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            body { font-family: 'Georgia', serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f9f9f9; }
                            .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; border-radius: 10px; }
                            .section { background: white; margin: 20px 0; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                            .section h3 { color: #667eea; margin-bottom: 15px; }
                            .education-item, .experience-item, .project-item { margin: 15px 0; padding: 10px; border-left: 3px solid #667eea; }
                            .meta { color: #666; font-style: italic; }
                            .skill-tag { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 4px 12px; margin: 4px; border-radius: 15px; display: inline-block; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>{{fullName}}</h1>
                            <p>{{email}} ‚Ä¢ {{phone}} ‚Ä¢ {{city}} ‚Ä¢ {{linkedin}}</p>
                        </div>
                        <div class="section">
                            <h3>Professional Summary</h3>
                            <p>{{summary}}</p>
                        </div>
                        <div class="section">
                            <h3>Education</h3>
                            {{education}}
                        </div>
                        <div class="section">
                            <h3>Experience</h3>
                            {{experience}}
                        </div>
                        <div class="section">
                            <h3>Projects</h3>
                            {{projects}}
                        </div>
                        <div class="section">
                            <h3>Skills</h3>
                            {{skills}}
                        </div>
                    </body>
                    </html>
                `
            };
            
            return templates[templateId] || templates.template1;
        }

        // Override template loading for demo
        async function loadAvailableTemplates() {
            const templatesGrid = document.getElementById('templatesGrid');
            templatesGrid.innerHTML = '';

            const demoTemplates = [
                {
                    id: 'template1',
                    name: 'Modern Professional',
                    description: 'Clean and modern design perfect for tech and business professionals',
                    features: ['ATS-Friendly', 'Clean Layout', 'Professional']
                },
                {
                    id: 'template2',
                    name: 'Creative Designer',
                    description: 'Stylish and creative layout ideal for designers and creative roles',
                    features: ['Creative', 'Visual Impact', 'Modern']
                }
            ];

            for (const template of demoTemplates) {
                const templateCard = document.createElement('div');
                templateCard.className = 'template-card';
                templateCard.onclick = () => selectTemplate(template.id);
                
                templateCard.innerHTML = `
                    <div class="template-preview">
                        <div style="padding: 20px; font-size: 12px; height: 100%; overflow: hidden;">
                            <div style="font-weight: bold; margin-bottom: 10px;">{{Your Name}}</div>
                            <div style="font-size: 10px; color: #666; margin-bottom: 15px;">email@example.com ‚Ä¢ (555) 123-4567</div>
                            <div style="border-bottom: 1px solid #ccc; margin-bottom: 10px; font-weight: bold;">Summary</div>
                            <div style="font-size: 10px; margin-bottom: 15px;">Professional summary text here...</div>
                            <div style="border-bottom: 1px solid #ccc; margin-bottom: 10px; font-weight: bold;">Experience</div>
                            <div style="font-size: 10px;">Job Title<br><span style="color: #666;">Company ‚Ä¢ Duration</span></div>
                        </div>
                    </div>
                    <div class="template-info">
                        <h3>${template.name}</h3>
                        <p>${template.description}</p>
                        <div class="template-features">
                            ${template.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                        </div>
                    </div>
                `;
                
                templatesGrid.appendChild(templateCard);
                availableTemplates.push(template);
            }
        }

        // Override confirm template selection for demo
        async function confirmTemplateSelection() {
            if (!selectedTemplate) return;
            
            const template = availableTemplates.find(t => t.id === selectedTemplate);
            if (!template) return;
            
            // Save selected template
            saveToStorage('selectedTemplate', selectedTemplate);
            
            // Load template content (using demo templates)
            currentTemplateData = createSampleTemplate(selectedTemplate);
            
            // Update UI
            document.getElementById('currentTemplateName').textContent = template.name;
            closeTemplateModal();
            
            // Update preview
            updatePreview();
            
            // Start auto-save
            startAutoSave();
            
            showSuccessMessage(`Template "${template.name}" loaded successfully!`);
        }*/
    </script>
</body>
</html>